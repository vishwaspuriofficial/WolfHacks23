<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    
</head>
<body >
    <div class="wrapper" style="position: absolute; top: 0; left: 0;">
            <img id="map" src="map1000/full.png" width="100%" height="auto">
            <button onclick="del()">Reset</button>
            <button id="get_path">Get path</button>
        </div>
</body>
<script>
    var ax = 0;
    var ay = 0;
    var bx = 0;
    var by = 0;
    // on button click
    document.getElementById("get_path").addEventListener("click", function(){
        let formData = new FormData();
        formData.append('starting_x', Math.floor(ax/2));
        formData.append('starting_y', Math.floor(ay/2));
        formData.append('ending_x', Math.floor(bx/2));
        formData.append('ending_y', Math.floor(by/2));
        formData.append('map_name', 'map500new');
        fetch("/api/get_path", {
          method: "POST",
          body: formData
        }).then(async res => {
            console.log("Request complete! response:", res);
            const data = await res.json();
            const path = data.path;
            console.log(path)
            draw_path(path);
        });
    });
    var count = 0
    map.onclick = function(e) {
        console.log(e.offsetX,e.offsetY)
        if (count==0) {
            const img = new Image(50, 50);
            img.id = "A";
            img.src = "A.png"; 
            ay = e.offsetY-50
            ax = e.offsetX-25
            img.style=`position: absolute; top:${ay}px; left:${ax}px`;
            document.body.appendChild(img);
        }
        else if (count==1) {
            const img = new Image(50, 50);
            img.src = "B.png"; 
            img.id = "B";
            by = e.offsetY-50
            bx = e.offsetX-25
            img.style=`position: absolute; top:${by}px; left:${bx}px`;
            document.body.appendChild(img);
        }
        count+=1
      };
    function del() {
        count=0;
        document.getElementById("A").remove();
        document.getElementById("B").remove();
        document.body.getElementById("Path").remove();
    }

    function draw_path(array) {
        for (const pix of array){
            const img = new Image(10, 10);
            img.src = "path.png"; 
            img.id = "Path";
            img.style=`position: absolute; top:${pix[0]*2-5}px; left:${pix[1]*2-5}px`;
            document.body.appendChild(img);
        }
    }

    
    
</script>
</html>